(function(){"use strict";var e=15;var t=8;angular.module("registry",["ngRoute","ui.bootstrap","kubernetes.app","registry.images","registry.projects","kubeClient","kubeClient.cockpit"]).config(["$routeProvider","KubeWatchProvider","KubeRequestProvider","KubeDiscoverSettingsProvider","$provide",function(e,t,r,o,a){e.when("/",{templateUrl:"views/registry-dashboard-page.html",controller:"DashboardCtrl",reloadOnSearch:false}).otherwise({redirectTo:"/"});t.KubeWatchFactory="CockpitKubeWatch";r.KubeRequestFactory="CockpitKubeRequest";o.KubeDiscoverSettingsFactory="cockpitKubeDiscoverSettings";a.decorator("$exceptionHandler",["$delegate","$log",function(e,t){return function(t,r){if(window.parent!==window&&window.name.indexOf("cockpit1:")===0)window.parent.postMessage('\n{ "command": "oops" }',"*");e(t,r)}}])}]).controller("DashboardCtrl",["$scope","kubeLoader","kubeSelect","imageData","imageActions","projectActions","filterService",function(r,o,a,i,n,c,s){o.load("projects");i.watchImages();function u(e,t){e=(e.metadata||{}).resourceVersion||0;t=(t.metadata||{}).resourceVersion||0;return t-e}function d(e,t){e=(e.items[0]||{}).created||"";t=(t.items[0]||{}).created||"";return t<e?-1:t>e?1:0}function l(e){var r=e.stream.status||{};var o=(r.tags||[]).slice();o.sort(d);o.splice(t)}a.register("buildRecentStreams",function(){var r,o=[];for(r in this)o.push(this[r]);o.sort(u);o.splice(e);var a=[];var i,n,c,s,l,g;for(s=0,l=o.length;s<l;s++){c=o[s];i=c.status||{};n=(i.tags||[]).slice();n.sort(d);g=n.length;n.splice(t);if(n.length>0)a.push({stream:c,tags:n,truncated:g>n.length})}return a});r.createProject=c.createProject;r.createImageStream=n.createImageStream;r.recentlyUpdated=function g(){return a().kind("ImageStream").buildRecentStreams()};r.projects=function p(){return a().kind("Project")};r.filter=s}])})();
