(function(){"use strict";angular.module("kubernetes.app",["ui.bootstrap","kubeClient","kubeClient.cockpit"]).controller("MainCtrl",["$scope","$location","$rootScope","$timeout","kubeLoader","kubeSelect","KubeDiscoverSettings","filterService",function(e,t,n,r,i,u,a,o){e.settings={};e.viewActive=function(e){var n=t.url()||"/";var r=n.split("?")[0].split("/");if(!e&&!r[1])return true;if(e===r[1])return true;return false};e.viewUrl=function(e){var t,n=i.limits.namespace;if(angular.isArray(n))n=null;if(!e){if(n)return"/?namespace="+encodeURIComponent(n);else return"/"}else{t=[e];if(n)t.push(n);return"/"+t.map(encodeURIComponent).join("/")}};e.console=console;function c(){document.getElementsByTagName("body")[0].removeAttribute("hidden")}r(c,3e3);function s(t){e.curtains={};a(t).then(function(t){e.settings=t;e.curtains=null;o.globals(t.isAdmin);o.load().then(c)},function(t){e.curtains={status:t.status,message:t.message||t.statusText};e.settings=null;c()})}s();e.reconnect=function(){a(true);i.reset();s()};i.listen(function(){n.$applyAsync()})}]).directive("filterBar",["filterService",function(e){return{restrict:"E",scope:true,link:function(t,n,r){t.filter=e},templateUrl:"views/filter-bar.html"}}]).directive("filterProject",["filterService",function(e){return{restrict:"E",scope:true,link:function(t,n,r){t.filter=e},templateUrl:"views/filter-project.html"}}]).factory("filterService",["$q","$route","$rootScope","kubeLoader","kubeSelect","KubeDiscoverSettings",function(e,t,n,r,i,u){var a=true;var o=u().then(function(t){var n;if(t.flavor==="openshift")n=r.load("projects");if(t.isAdmin)n=r.watch("namespaces");return n||e.when([])});r.listen(function(e){var n,r,i;for(n in e){i=e[n];if(i.kind=="Namespace"||i.kind=="Project"){s(t.current);return}}});function c(){var e;if(a)e=i().kind("Namespace");if(!e||e.length===0)e=i().kind("Project");var t,n,r=[];for(t in e){n=e[t].metadata||{};if(n.name)r.push(n.name)}return r}function s(e){var t=null;if(e)t=e.params["namespace"]||null;if(t===null&&!a){t=c();if(t.length<1)t=null}if(!angular.equals(t,r.limit.namespaces)){r.limit({namespace:t})}}n.$on("$routeChangeSuccess",function(e,t,n){s(t)});n.$on("$routeUpdate",function(e,t,n){s(t)});if(t.current)s(t.current);return{load:function(){return o},globals:function(e){if(arguments.length===0)return a;e=!!e;if(a!==e){a=e;s(t.current)}},namespaces:c,namespace:function(e){if(arguments.length===0)return t.current.params["namespace"];var n=angular.copy(t.current.params);n["namespace"]=e||undefined;n["target"]=null;t.updateParams(n)}}}]).filter("orderObjectBy",function(){return function(e,t){var n,r=[];for(n in e)r.push(e[n]);if(!angular.isArray(t))t=[String(i)];var i=t.map(function(e){return e.split(".")});function u(e,t){return e?e[t]:undefined}r.sort(function(e,t){var n,r,a,o=i.length;for(a=0;a<o;a++){n=i[a].reduce(u,e);r=i[a].reduce(u,t);if(n===r)continue;return n>r?1:-1}return 0});return r}}).filter("formatBytes",["KubeFormat",function(e){return function(t){if(typeof t=="number")return e.formatBytes(t);return t}}])})();
