define(["jquery","base1/cockpit","base1/mustache","kubernetes/client","base1/patterns"],function(e,n,a,r){"use strict";var t=n.gettext;var i=e.scoped("#node-dialog");var o=null;var s=/^[a-z0-9.-]+$/i;var d=i("#node-dialog",document);d.on("show.bs.modal",function(e){o=r.k8client();i(".configure-option input").attr("disabled","disabled");i("#node-name").val("");i("#node-address").val("")}).on("shown.bs.modal",function(){i("#node-address").focus()}).on("hide.bs.modal",function(e){o.close();o=null});function l(){var e=[];var n=[];var a=i("#node-name").val().trim();var r=i("#node-address").val().trim();var o;if(!r)o=new Error(t("Please type an address"));else if(!s.test(r))o=new Error(t("The address contains invalid characters"));if(o){o.target="#node-address";e.push(o)}if(a&&!s.test(a)){o=new Error(t("The name contains invalid charaters"));o.target="#node-name";e.push(o)}if(e.length){d.dialog("failure",e);return null}if(!a)a=r;var l={kind:"Node",apiVersion:"v1",metadata:{name:a},spec:{externalID:r}};return[l]}var c=false;i("#node-name").on("input",function(){c=true});i("#node-address").on("input",function(){if(!c)i("#node-name").val(i(this).val())});d.on("keypress",function(e){if(e.keyCode===13)i(".btn-primary").trigger("click")});i(".btn-primary").on("click",function(){var e=l();if(!e)return;var n=o.create(e);d.dialog("promise",n)})});
