define(["jquery"],function(t){function e(){var t=document.createElement("p");var e=false;if(t.addEventListener)t.addEventListener("DOMAttrModified",function(){e=true},false);else if(t.attachEvent)t.attachEvent("onDOMAttrModified",function(){e=true});else return false;t.setAttribute("id","target");return e}function a(e,a){if(e){var r=this.data("attr-old-value");if(a.attributeName.indexOf("style")>=0){if(!r["style"])r["style"]={};var i=a.attributeName.split(".");a.attributeName=i[0];a.oldValue=r["style"][i[1]];a.newValue=i[1]+":"+this.prop("style")[t.camelCase(i[1])];r["style"][i[1]]=a.newValue}else{a.oldValue=r[a.attributeName];a.newValue=this.attr(a.attributeName);r[a.attributeName]=a.newValue}this.data("attr-old-value",r)}}var r=window.MutationObserver||window.WebKitMutationObserver;t.fn.attrchange=function(i){var n={trackValues:false,callback:t.noop};if(typeof i==="function"){n.callback=i}else{t.extend(n,i)}if(n.trackValues){t(this).each(function(e,a){var r={};for(var i,n=0,l=a.attributes,u=l.length;n<u;n++){i=l.item(n);r[i.nodeName]=i.value}t(this).data("attr-old-value",r)})}if(r){var l={subtree:false,attributes:true,attributeOldValue:n.trackValues};var u=new r(function(e){e.forEach(function(e){var a=e.target;if(n.trackValues){e.newValue=t(a).attr(e.attributeName)}n.callback.call(a,e)})});return this.each(function(){u.observe(this,l)})}else if(e()){return this.on("DOMAttrModified",function(t){if(t.originalEvent)t=t.originalEvent;t.attributeName=t.attrName;t.oldValue=t.prevValue;n.callback.call(this,t)})}else if("onpropertychange"in document.body){return this.on("propertychange",function(e){e.attributeName=window.event.propertyName;a.call(t(this),n.trackValues,e);n.callback.call(this,e)})}return this}});
