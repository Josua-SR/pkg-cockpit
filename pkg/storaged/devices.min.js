define(["jquery","base1/cockpit","storage/client","storage/jobs","storage/overview","storage/details","storage/utils","translated!base1/po"],function(t,o,a,e,i,n,r,l){o.locale(l);var s=o.gettext;var c=o.gettext;function d(){var l;var c;var d;t("body").on("click","[data-goto-block]",function(){o.location.go([t(this).attr("data-goto-block")])});t("body").on("click","[data-goto-mdraid]",function(){o.location.go(["mdraid",t(this).attr("data-goto-mdraid")])});t("body").on("click","[data-goto-vgroup]",function(){o.location.go(["vg",t(this).attr("data-goto-vgroup")])});function g(){var a=o.location.path;if(a.length===0){d.hide();c.show()}else if(a.length==1){c.hide();d.show("block",a[0])}else if(a.length==2&&a[0]=="mdraid"){c.hide();d.show("mdraid",a[1])}else if(a.length==2&&a[0]=="vg"){c.hide();d.show("vgroup",a[1])}else{console.warn("not a init location: "+a);o.location=""}t("body").show()}a.init(function(){o.translate();if(a.features===false){t("#unsupported").show();t("body").show()}else{l=e.init(a);c=i.init(a,l);d=n.init(a,l);t(o).on("locationchanged",g);g()}});var u=r.get_multipathd_service();function h(){var o=!u.state||u.state==="running";var e=a.broken_multipath_present===true;t("#multipath-broken").toggle(e&&!o)}t(u).on("changed",h);t(a).on("changed",h);h();t("#activate-multipath").on("click",function(){o.spawn(["mpathconf","--enable","--with_multipathd","y"],{superuser:"try"}).fail(function(o){t("#error-popup-title").text(s("Error"));t("#error-popup-message").text(o.toString());t("#error-popup").modal("show")})})}return d});
