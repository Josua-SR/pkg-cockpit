!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=3)}([function(e,n){e.exports=jQuery},function(e,n){e.exports=cockpit},function(e,n){e.exports='#! /bin/bash\n\npresent () {\n    which "$1" >/dev/null 2>/dev/null\n}\n\nif present sosreport; then\n    exec sosreport "$@"\nelif present atomic; then\n\n    # HACK - sosreport inside the container does not behave as\n    #        advertised, so we fix it via --sysroot and --tmp-dir.\n    #\n    # https://bugzilla.redhat.com/show_bug.cgi?id=1299794\n    # https://bugzilla.redhat.com/show_bug.cgi?id=1277223\n\n    exec atomic run rhel7/support-tools -- sosreport --sysroot /host --tmp-dir /host/var/tmp "$@"\nelse\n    echo >&2 "The sosreport utility is not installed.  This should not happen.  Please complain to your distribution vendor."\n    exit 1\nfi\n'},function(e,n,t){t(4),e.exports=t(5)},function(e,n,t){"use strict";t.r(n);var o=t(1),r=t.n(o),s=t(0),i=t.n(s),a=t(2),c=t.n(a);const l=r.a.gettext;var u,p,d;function f(){!function(){i()("#sos-progress .progress-bar").css("width","0%"),i()("#sos-download, #sos-error").hide(),i()("#sos-cancel").text(l("Cancel")),p=null,d=[];var e=r.a.script(c.a,["--batch"],{superuser:!0,err:"out",pty:!0});u=e;var n="",t=0,o=/Running ([0-9]+)\/([0-9]+):/,s=/Finishing plugins.*\[Running: (.*)\]/,a=/Starting ([0-9]+)\/([0-9]+).*\[Running: (.*)\]/,f=/Your sosreport has been generated and saved in:[ \r\n]+(\/[^\r\n]+)/;e.stream(function(r){if(u==e){var c,l;l=0;for(var p=(n+=r).split("\n"),d=p.length-1;d>=0;d--){if(c=a.exec(p[d])){t=parseInt(c[2],10),l=(parseInt(c[1],10)-c[3].split(" ").length)/t*100;break}if(c=s.exec(p[d])){l=t?(t-c[1].split(" ").length)/t*100:100;break}if(c=o.exec(p[d])){l=parseInt(c[1],10)/parseInt(c[2],10)*100;break}}i()("#sos-alert, #sos-progress").show(),i()("#sos-progress .progress-bar").css("width",l.toString()+"%")}}),e.done(function(){if(u==e){var t=f.exec(n);if(t){var o=t[1],s=o.replace(/.*\//,"");0===o.indexOf("/host")&&(o=o.substr(5)),d=[o,o+".md5"];var a=window.btoa(JSON.stringify({payload:"fsread1",binary:"raw",path:o,superuser:!0,max_read_size:157286400,external:{"content-disposition":'attachment; filename="'+s+'"',"content-type":"application/x-xz, application/octet-stream"}}));p="/cockpit/channel/"+r.a.transport.csrf_token+"?"+a,i()("#sos-progress, #sos-error").hide(),i()("#sos-alert, #sos-download").show(),i()("#sos-cancel").text(l("Close"))}else h(l("No archive has been created."),n);u=null}}),e.fail(function(t){u==e&&(h(t.toString(),n),u=null)})}()}function h(e,n){i()("#sos-alert, #sos-progress, #sos-download").hide(),i()("#sos-error .alert-message").text(e),n?(i()("#sos-error-extra").text(n),i()("#sos-error-extra").show()):i()("#sos-error-extra").hide(),i()("#sos-error").show(),i()("#sos-cancel").text(l("Close"))}function g(){u&&(u.close("cancelled"),u=null),d.length>0&&r.a.spawn(["rm"].concat(d),{superuser:!0,err:"message"}).fail(function(e){console.log("failed to remove",d,e)}),p=null,d=[],i()("#sos").modal("hide")}function b(){var e=i()("<iframe>").attr("src",p).hide();e.on("load",function(n){var t=e.get(0).contentDocument.title;t&&h(t)}),i()("body").append(e)}i()(function(){i()("#sos").on("show.bs.modal",f),i()("#sos-cancel").on("click",g),i()("#sos-download button").on("click",b),r.a.translate(),i()("body").show(),r.a.transport.wait(function(){})})},function(e,n){}]);
//# sourceMappingURL=sosreport.min.js.map