var url_root;

try {
    url_root = window.localStorage.getItem("url-root");
} catch (e) {}

var mock = mock || {};

var phantom_checkpoint = phantom_checkpoint || function() {};

(function() {
    "use strict";
    if (typeof window.debugging === "undefined") {
        try {
            window.debugging = window.sessionStorage["debugging"] || window.localStorage["debugging"];
        } catch (e) {}
    }
    function n(e, n) {
        var t = e.length;
        for (var r = 0; r < t; r++) {
            if (n === e[r]) return true;
        }
        return false;
    }
    function t(e) {
        return Object.prototype.toString.call(e) === "[object Array]";
    }
    function r(e) {
        return typeof e === "function";
    }
    function i(e) {
        return e !== null && typeof e === "object";
    }
    function o(e) {
        return i(e) && Object.prototype.toString.call(e) === "[object Object]";
    }
    function a(e) {
        return ((e = +e) || 1 / e) < 0;
    }
    function s(e) {
        var n, t, r, i;
        for (n = 1, t = arguments.length; n < t; n++) {
            i = arguments[n];
            if (i) {
                for (r in i) {
                    if (i[r] !== undefined) e[r] = i[r];
                }
            }
        }
        return e;
    }
    function f(e, n, t) {
        var r = e ? e.length : 0;
        for (var i = 0; i < r; i++) {
            if (e[i]) e[i].apply(n, t);
        }
    }
    var l = null;
    var u = null;
    var c = false;
    var d = false;
    var p = null;
    var v = null;
    var h = null;
    var m = [];
    var g = !!window.ArrayBuffer;
    var w = window.location.origin;
    if (!w) {
        w = window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "");
    }
    function b(e, n) {
        var t = e.length;
        var r = new (n || Array)(t);
        for (var i = 0; i < t; i++) r[i] = e.charCodeAt(i) & 255;
        return r;
    }
    function y(e) {
        var n = e.length, t = "";
        for (var r = 0; r < n; r++) t += String.fromCharCode(e[r]);
        return t;
    }
    function k(e) {
        return e < 26 ? e + 65 : e < 52 ? e + 71 : e < 62 ? e - 4 : e === 62 ? 43 : e === 63 ? 47 : 65;
    }
    function _(e) {
        if (typeof e === "string") return window.btoa(e);
        if (g && e instanceof window.ArrayBuffer) e = new window.Uint8Array(e);
        var n = e.length, t = 2, r = "";
        for (var i = 0, o = 0; o < n; o++) {
            t = o % 3;
            i |= e[o] << (16 >>> t & 24);
            if (t === 2 || n - o === 1) {
                r += String.fromCharCode(k(i >>> 18 & 63), k(i >>> 12 & 63), k(i >>> 6 & 63), k(i & 63));
                i = 0;
            }
        }
        return r.substr(0, r.length - 2 + t) + (t === 2 ? "" : t === 1 ? "=" : "==");
    }
    function x(e) {
        return e > 64 && e < 91 ? e - 65 : e > 96 && e < 123 ? e - 71 : e > 47 && e < 58 ? e + 4 : e === 43 ? 62 : e === 47 ? 63 : 0;
    }
    function E(e, n) {
        if (n === String) return window.atob(e);
        var t = e.length;
        for (var r = 0; r < 3; r++) {
            if (e[t - (r + 1)] != "=") break;
        }
        var i = (t * 3 + 1 >> 2) - r;
        var o = new (n || Array)(i);
        for (var a, s, f = 0, l = 0, u = 0; u < t; u++) {
            s = u & 3;
            f |= x(e.charCodeAt(u)) << 18 - 6 * s;
            if (s === 3 || t - u === 1) {
                for (a = 0; a < 3 && l < i; a++, l++) o[l] = f >>> (16 >>> a & 24) & 255;
                f = 0;
            }
        }
        return o;
    }
    window.addEventListener("beforeunload", function() {
        d = true;
    }, false);
    function S() {
        if (window.debugging == "all" || window.debugging == "channel") console.debug.apply(console, arguments);
    }
    function j(e, n) {
        Object.defineProperties(e, {
            addEventListener: {
                enumerable: false,
                value: function t(e, r) {
                    if (n[e] === undefined) n[e] = [];
                    n[e].push(r);
                }
            },
            removeEventListener: {
                enumerable: false,
                value: function i(e, t) {
                    var r = n[e] ? n[e].length : 0;
                    for (var i = 0; i < r; i++) {
                        if (n[e][i] === t) {
                            n[e][i] = null;
                            break;
                        }
                    }
                }
            },
            dispatchEvent: {
                enumerable: false,
                value: function o(t) {
                    var i, o;
                    if (typeof t === "string") {
                        i = t;
                        o = Array.prototype.slice.call(arguments, 1);
                        t = document.createEvent("CustomEvent");
                        if (arguments.length == 2) t.initCustomEvent(i, false, false, arguments[1]); else if (arguments.length > 2) t.initCustomEvent(i, false, false, o); else t.initCustomEvent(i, false, false, null);
                        o.unshift(t);
                    } else {
                        i = t.type;
                        o = arguments;
                    }
                    if (r(e["on" + i])) e["on" + i].apply(e, o);
                    f(n[i], e, o);
                }
            }
        });
    }
    function O() {
        var e = window.location.pathname || "/";
        var n = url_root;
        if (window.mock && window.mock.pathname) e = window.mock.pathname;
        if (window.mock && window.mock.url_root) n = window.mock.url_root;
        if (n && e.indexOf("/" + n) === 0) e = e.replace("/" + n, "") || "/";
        if (e.indexOf("/cockpit/") !== 0 && e.indexOf("/cockpit+") !== 0) {
            if (e.indexOf("/=") === 0) e = "/cockpit+" + e.split("/")[1]; else e = "/cockpit";
        }
        return e.split("/")[1];
    }
    function C(e) {
        if (!e) e = "socket";
        var n = window.location.toString();
        var t = url_root;
        if (window.mock && window.mock.url) return window.mock.url;
        if (window.mock && window.mock.url_root) t = window.mock.url_root;
        var r = O();
        if (t) r = t + "/" + r;
        if (n.indexOf("http:") === 0) {
            return "ws://" + window.location.host + "/" + r + "/" + e;
        } else if (n.indexOf("https:") === 0) {
            return "wss://" + window.location.host + "/" + r + "/" + e;
        } else {
            S("Cockpit must be used over http or https");
            return null;
        }
    }
    function I(e, n) {
        if (!n) return e.join("");
        var t;
        var r, i, o = 0;
        var a, s = e.length;
        for (a = 0; a < s; a++) o += e[a].length;
        if (window.Uint8Array) t = new window.Uint8Array(o); else t = new Array(o);
        if (t.set) {
            for (r = 0, a = 0; a < s; a++) {
                t.set(e[a], r);
                r += e[a].length;
            }
        } else {
            for (r = 0, a = 0; a < s; a++) {
                for (i = 0; i < e[a].length; i++) t[a + r] = e[a][i];
                r += e[a].length;
            }
        }
        return t;
    }
    function L(e) {
        var n = this;
        n.readyState = 0;
        window.addEventListener("message", function t(r) {
            if (r.origin !== w || r.source !== e) return;
            var i = r.data;
            if (i === undefined || i.length === undefined) return;
            if (i.length === 0) {
                n.readyState = 3;
                n.onclose();
            } else {
                n.onmessage(r);
            }
        }, false);
        n.send = function r(n) {
            e.postMessage(n, w);
        };
        n.close = function i() {
            n.readyState = 3;
            e.postMessage("", w);
            n.onclose();
        };
        window.setTimeout(function() {
            n.readyState = 1;
            n.onopen();
        }, 0);
    }
    function A() {
        var e = this;
        e.application = O();
        j(e, {});
        var r = 0;
        var i = "";
        if (window.mock) window.mock.last_transport = e;
        var o;
        var a;
        var s = false;
        if (window.parent !== window && window.name.indexOf("cockpit1:") === 0) o = new L(window.parent);
        try {
            if (!o && window.parent !== window && window.parent.options && window.parent.options.protocol == "cockpit1") {
                o = new L(window.parent);
            }
        } catch (f) {}
        if (!o) {
            var l = C();
            S("connecting to " + l);
            if (l) {
                if ("WebSocket" in window) {
                    o = new window.WebSocket(l, "cockpit1");
                } else if ("MozWebSocket" in window) {
                    o = new window.MozWebSocket(l);
                } else {
                    console.error("WebSocket not supported, application will not work!");
                }
            }
            a = window.setInterval(function() {
                if (!s) {
                    console.log("health check failed");
                    e.close({
                        problem: "timeout"
                    });
                }
                s = false;
            }, 3e4);
        }
        if (!o) {
            o = {
                close: function() {}
            };
            window.setTimeout(function() {
                e.close({
                    problem: "no-cockpit"
                });
            }, 50);
        }
        var w = {};
        var y = {};
        var k = true;
        var _ = false;
        e.ready = false;
        e.binary = false;
        function x() {
            if (!e.ready) {
                e.ready = true;
                e.dispatchEvent("ready");
            }
        }
        o.onopen = function() {
            if (o) {
                if (typeof o.binaryType !== "undefined" && g) {
                    o.binaryType = "arraybuffer";
                    _ = true;
                }
                o.send('\n{ "command": "init", "version": 1 }');
            }
        };
        o.onclose = function() {
            S("WebSocket onclose");
            o = null;
            if (c) {
                d = true;
                window.location.reload(true);
            }
            if (d) return;
            e.close();
        };
        o.onmessage = function(e) {
            s = true;
            var n = e.data;
            var t = null;
            var r;
            var i;
            var o;
            if (g && n instanceof window.ArrayBuffer) {
                t = new window.Uint8Array(n);
                r = t.length;
                for (o = 0; o < r; o++) {
                    if (t[o] == 10) break;
                }
                if (o === r) {
                    console.warn("binary message without channel");
                    return;
                } else if (o === 0) {
                    console.warn("binary control message");
                    return;
                } else {
                    i = String.fromCharCode.apply(null, t.subarray(0, o));
                }
            } else {
                o = n.indexOf("\n");
                if (o === -1) {
                    console.warn("text message without channel");
                    return;
                }
                i = n.substring(0, o);
            }
            var a, f;
            if (t) a = new window.Uint8Array(t.buffer, o + 1); else a = n.substring(o + 1);
            if (!i) {
                S("recv control:", a);
                f = JSON.parse(a);
            } else {
                S("recv " + i + ":", a);
            }
            r = m.length;
            for (var l = 0; l < r; l++) {
                if (m[l](n, i, f) === false) return;
            }
            if (!i) A(f); else B(i, a);
            phantom_checkpoint();
        };
        e.close = function M(e) {
            if (!e) e = {
                problem: "disconnected"
            };
            e.command = "close";
            window.clearInterval(a);
            var n = o;
            o = null;
            if (n) n.close();
            x();
            for (var t in w) w[t].apply(null, [ e ]);
        };
        e.next_channel = function U() {
            r++;
            return i + String(r);
        };
        function E(t) {
            if (t.problem) {
                e.close({
                    problem: t.problem
                });
                return;
            }
            if (t.version !== 1) {
                console.error("received unsupported version in init message: " + t.version);
                e.close({
                    problem: "not-supported"
                });
                return;
            }
            if (n(t["capabilities"] || [], "binary")) e.binary = _;
            if (t["channel-seed"]) i = String(t["channel-seed"]);
            if (t["host"]) v = t["host"];
            if (u) {
                u.options = t;
                u.csrf_token = t["csrf-token"];
                u.host = v;
            }
            if (p) p(t);
            if (k) {
                k = false;
                x();
            }
        }
        function A(n) {
            var t = n.channel;
            var r;
            if (n.command == "init") {
                E(n);
            } else if (k) {
                k = false;
                if (n.command != "close" || t) {
                    console.error("received message before init: ", n.command);
                    n = {
                        problem: "protocol-error"
                    };
                }
                e.close(n);
            } else if (n.command == "ping") {} else if (n.command == "hint") {
                if (h) h(n);
            } else if (t !== undefined) {
                r = w[t];
                if (r) r.apply(null, [ n ]);
            }
        }
        function B(e, n) {
            var t = y[e];
            if (t) t.apply(null, [ n ]);
        }
        e.send_data = function P(e) {
            if (!o) {
                console.log("transport closed, dropped message: ", e);
                return false;
            } else {
                o.send(e);
                return true;
            }
        };
        e.send_message = function N(n, r) {
            if (n) S("send " + n, r); else S("send control:", r);
            if (r.byteLength || t(r)) {
                if (r instanceof window.ArrayBuffer) r = new window.Uint8Array(r);
                var i = I([ b(n), [ 10 ], r ], true);
                return e.send_data(i.buffer);
            } else {
                return e.send_data(n.toString() + "\n" + r);
            }
        };
        e.send_control = function T(n) {
            if (!o && (n.command == "close" || n.command == "kill")) return;
            e.send_message("", JSON.stringify(n));
        };
        e.register = function J(e, n, t) {
            w[e] = n;
            y[e] = t;
        };
        e.unregister = function R(e) {
            delete w[e];
            delete y[e];
        };
    }
    function B(e) {
        var n;
        if (!l) l = new A();
        n = l;
        if (n.ready) {
            e(n);
        } else {
            n.addEventListener("ready", function() {
                e(n);
            });
        }
    }
    function M(e) {
        var n = this;
        j(n, {});
        var t;
        var r = true;
        var i = false;
        var o = false;
        var a = null;
        var s = false;
        var f = e.binary === true;
        var l = [];
        n.valid = r;
        n.options = e;
        n.binary = f;
        n.id = a;
        function u(e) {
            if (i) {
                console.warn("received message after done");
                n.close("protocol-error");
            } else {
                if (s) e = E(e, window.Uint8Array || Array);
                n.dispatchEvent("message", e);
            }
        }
        function c(e) {
            n.valid = r = false;
            if (t && a) t.unregister(a);
            if (e.message) console.warn(e.message);
            n.dispatchEvent("close", e);
        }
        function d(e) {
            if (e.command == "close") {
                c(e);
                return;
            }
            var t = e.command === "done";
            if (t && i) {
                console.warn("received two done commands on channel");
                n.close("protocol-error");
            } else {
                if (t) i = true;
                n.dispatchEvent("control", e);
            }
        }
        function p(e) {
            if (f && s) {
                e = _(e);
            } else if (!f) {
                if (typeof e !== "string") e = String(e);
            }
            t.send_message(a, e);
        }
        B(function(i) {
            t = i;
            if (!r) return;
            a = t.next_channel();
            n.id = a;
            t.register(a, d, u);
            var o = {};
            for (var c in e) o[c] = e[c];
            o.command = "open";
            o.channel = a;
            if (!o.host) {
                if (v) o.host = v;
            }
            if (f) {
                if (t.binary) {
                    o.binary = "raw";
                } else {
                    o.binary = "base64";
                    s = true;
                }
            } else {
                delete o.binary;
            }
            t.send_control(o);
            while (l.length > 0) {
                var h = l.shift();
                if (h[0]) {
                    h[1]["channel"] = a;
                    t.send_control(h[1]);
                } else {
                    p(h[1]);
                }
            }
        });
        n.send = function h(e) {
            if (!r) console.warn("sending message on closed channel"); else if (o) console.warn("sending message after done"); else if (!t) l.push([ false, e ]); else p(e);
        };
        n.control = function m(e) {
            e = e || {};
            if (!e.command) e.command = "options";
            if (e.command === "done") o = true;
            e.channel = a;
            if (!t) l.push([ true, e ]); else t.send_control(e);
        };
        n.close = function g(e) {
            if (!r) return;
            if (!e) e = {}; else if (typeof e == "string") e = {
                problem: e
            };
            e["command"] = "close";
            e["channel"] = a;
            if (!t) l.push([ true, e ]); else t.send_control(e);
            c(e);
        };
        n.buffer = function w(e) {
            var t = [];
            t.callback = e;
            t.squash = function o() {
                return I(t, f);
            };
            function r(e, r) {
                var i, o;
                t.push(r);
                if (t.callback) {
                    o = I(t, f);
                    if (o.length > 0) {
                        i = t.callback.call(n, o);
                        if (typeof i !== "number" || i === o.length) {
                            t.length = 0;
                        } else if (i === 0) {
                            t.length = 1;
                            t[0] = o;
                        } else if (i !== 0) {
                            t.length = 1;
                            if (o.subarray) t[0] = o.subarray(i); else if (o.substring) t[0] = o.substring(i); else t[0] = o.slice(i);
                        }
                    }
                }
            }
            function i() {
                n.removeEventListener("message", r);
                n.removeEventListener("close", i);
            }
            n.addEventListener("message", r);
            n.addEventListener("close", i);
            return t;
        };
        n.toString = function b() {
            var n = e["host"] || "localhost";
            return "[Channel " + (r ? a : "<invalid>") + " -> " + n + "]";
        };
    }
    function U(e) {
        var n = [];
        var t = e.length;
        for (var r = 0; r < t; r++) {
            var i = e[r];
            if (i === "" || i == ".") {
                continue;
            } else if (i == "..") {
                if (n.length === 0) return null;
                n.pop();
            } else {
                n.push(i);
            }
        }
        return n;
    }
    function P(e, d) {
        e.channel = function Ce(e) {
            return new M(e);
        };
        e.event_target = function Ie(e) {
            j(e, {});
            return e;
        };
        e.extend = s;
        e.manifests = {};
        function g(e) {
            var n = this;
            n.encoding = "utf-8";
            n.encode = function t(n, r) {
                var i = window.unescape(encodeURIComponent(n));
                if (e === String) return i;
                return b(i, e);
            };
        }
        function k(e) {
            var n = this;
            var t = null;
            n.encoding = "utf-8";
            n.decode = function r(n, i) {
                var o = i && i.stream;
                if (n === null || n === undefined) n = "";
                if (typeof n !== "string") n = y(n);
                if (t) {
                    n = t + n;
                    t = null;
                }
                var a = 0, s = 0, f = n.length;
                var l, u, c, d;
                var p = "";
                while (s < f) {
                    l = n.charCodeAt(s);
                    u = l == 255 ? 0 : l > 251 && l < 254 ? 6 : l > 247 && l < 252 ? 5 : l > 239 && l < 248 ? 4 : l > 223 && l < 240 ? 3 : l > 191 && l < 224 ? 2 : l < 128 ? 1 : 0;
                    d = s + u <= f;
                    if (!d && o) {
                        t = n.substring(s);
                        break;
                    }
                    if (u === 0) d = false;
                    for (c = 1; d && c < u; c++) d = (n.charCodeAt(s + c) & 128) !== 0;
                    if (!d) {
                        if (e) {
                            s = f;
                            break;
                        }
                        p += decodeURIComponent(window.escape(n.substring(a, s)));
                        p += "�";
                        s++;
                        a = s;
                    } else {
                        s += u;
                    }
                }
                p += decodeURIComponent(window.escape(n.substring(a, s)));
                return p;
            };
        }
        e.utf8_encoder = function Le(e) {
            return new g(e);
        };
        e.utf8_decoder = function Ae(e) {
            return new k((!!e));
        };
        e.base64_encode = _;
        e.base64_decode = E;
        e.kill = function Be(e, n) {
            var t = {
                command: "kill"
            };
            if (e) t.host = e;
            if (n) t.group = n;
            B(function(e) {
                e.send_control(t);
            });
        };
        e.hint = function Me(e, n) {
            if (!n) n = v;
            var t = {
                command: "hint",
                hint: e,
                host: n
            };
            B(function(e) {
                e.send_control(t);
            });
        };
        e.transport = u = {
            wait: B,
            inject: function Ue(e) {
                if (!l) return false;
                return l.send_data(e);
            },
            filter: function Pe(e) {
                m.push(e);
            },
            close: function Ne(e) {
                var n;
                if (e) n = {
                    problem: e
                };
                if (l) l.close(n);
                l = null;
                this.options = {};
            },
            origin: w,
            options: {},
            uri: C,
            application: function() {
                if (!l || window.mock) return O();
                return l.application;
            }
        };
        var x = [];
        var S = null;
        function L() {
            var e, n = x;
            S = null;
            x = [];
            for (;;) {
                e = n.shift();
                if (!e) break;
                e();
            }
        }
        function A(e) {
            if (e) x.push(e);
            if (S === null) S = window.setTimeout(L, 0);
        }
        function P(e, n, t, r) {
            if (n === undefined && t === undefined && r === undefined) return null;
            var i = new q();
            e.pending = e.pending || [];
            e.pending.push([ i, n, t, r ]);
            if (e.status > 0) J(e);
            return i.promise;
        }
        function N(e) {
            var n = function t(e) {
                if (e) {
                    s(e, n);
                    return e;
                }
                return n;
            };
            e.status = 0;
            n.then = function r(t, i, o) {
                return P(e, t, i, o) || n;
            };
            n["catch"] = function i(t) {
                return P(e, null, t) || n;
            };
            n["finally"] = function o(t, r) {
                return P(e, function() {
                    return H(arguments, true, t);
                }, function() {
                    return H(arguments, false, t);
                }, r) || n;
            };
            n.done = function a(t) {
                P(e, t);
                return n;
            };
            n.fail = function f(t) {
                P(e, null, t);
                return n;
            };
            n.always = function l(t) {
                P(e, t, t);
                return n;
            };
            n.progress = function u(t) {
                P(e, null, null, t);
                return n;
            };
            n.state = function c() {
                if (e.status == 1) return "resolved";
                if (e.status == 2) return "rejected";
                return "pending";
            };
            n.promise = n;
            return n;
        }
        function T(e) {
            var n, t, i;
            i = e.pending;
            e.process_scheduled = false;
            e.pending = undefined;
            for (var o = 0, a = i.length; o < a; ++o) {
                e.pur = true;
                t = i[o][0];
                n = i[o][e.status];
                if (r(n)) {
                    t.resolve(n.apply(e.promise, e.values));
                } else if (e.status === 1) {
                    t.resolve.apply(t.resolve, e.values);
                } else {
                    t.reject.apply(t.reject, e.values);
                }
            }
        }
        function J(e) {
            if (e.process_scheduled || !e.pending) return;
            e.process_scheduled = true;
            A(function() {
                T(e);
            });
        }
        function R(e, n) {
            var t, o = false;
            if (i(n[0]) || r(n[0])) t = n[0] && n[0].then;
            if (r(t)) {
                e.status = -1;
                t.call(n, function() {
                    if (o) return;
                    o = true;
                    R(e, arguments);
                }, function() {
                    if (o) return;
                    o = true;
                    D(e, arguments);
                }, function() {
                    $(e, arguments);
                });
            } else {
                e.values = n;
                e.status = 1;
                J(e);
            }
        }
        function D(e, n) {
            e.values = n;
            e.status = 2;
            J(e);
        }
        function $(e, n) {
            var t = e.pending;
            if (e.status <= 0 && t && t.length) {
                A(function() {
                    var i, o;
                    for (var a = 0, s = t.length; a < s; a++) {
                        o = t[a][0];
                        i = t[a][3];
                        if (r(i)) o.notify(i.apply(e.promise, n)); else o.notify.apply(o, n);
                    }
                });
            }
        }
        function q() {
            var e = this;
            var n = {};
            e.promise = n.promise = N(n);
            e.resolve = function t() {
                if (arguments[0] === n.promise) throw new Error("Expected promise to be resolved with other value than itself");
                if (!n.status) R(n, arguments);
                return e;
            };
            e.reject = function r() {
                if (n.status) return;
                D(n, arguments);
                return e;
            };
            e.notify = function i() {
                $(n, arguments);
                return e;
            };
        }
        function G(n, t) {
            var r = e.defer();
            if (t) r.resolve.apply(r, n); else r.reject.apply(r, n);
            return r.promise;
        }
        function H(e, n, t) {
            var i = null;
            if (r(t)) i = t();
            if (i && r(i.then)) {
                return i.then(function() {
                    return G(e, n);
                }, function() {
                    return G(arguments, false);
                });
            } else {
                return G(e, n);
            }
        }
        e.when = function Te(n, t, r, i) {
            var o = e.defer();
            o.resolve(n);
            return o.promise.then(t, r, i);
        };
        e.all = function Je(n) {
            var r = e.defer();
            var i = 0;
            var o = [];
            if (arguments.length != 1 && !t(n)) n = Array.prototype.slice.call(arguments);
            n.forEach(function(n, t) {
                i++;
                e.when(n).then(function(e) {
                    o[t] = e;
                    if (!--i) r.resolve.apply(r, o);
                }, function() {
                    r.reject.apply(r, arguments);
                });
            });
            if (i === 0) r.resolve(o);
            return r.promise;
        };
        e.resolve = function Re(n) {
            return e.defer().resolve(n).promise;
        };
        e.reject = function De(n) {
            return e.defer().reject(n).promise;
        };
        e.defer = function() {
            return new q();
        };
        var K = /\$\{([^}]+)\}|\$([a-zA-Z0-9_]+)/g;
        e.format = function $e(e, n) {
            if (arguments.length != 2 || !i(n) || n === null) n = Array.prototype.slice.call(arguments, 1);
            return e.replace(K, function(e, t, r) {
                return n[t || r] || "";
            });
        };
        e.format_number = function qe(e) {
            if (e > 0 && e < .1) e = .1; else if (e < 0 && e > -.1) e = -.1;
            if (!e && e !== 0) return ""; else if (e % 1 === 0) return e.toString(); else return e.toFixed(1);
        };
        function z(n, t, r, i) {
            var o;
            var a = null;
            var s, f;
            var l;
            var u, c, d;
            if (!n && n !== 0) {
                a = null;
            } else if (typeof r === "string") {
                f = [];
                for (s in t) f.push(s);
                f.sort().reverse();
                for (u = 0; u < f.length; u++) {
                    for (c = 0; c < t[f[u]].length; c++) {
                        if (r == t[f[u]][c]) {
                            n = n / Math.pow(f[u], c);
                            a = r;
                            break;
                        }
                    }
                    if (a) break;
                }
            } else if (r in t) {
                l = 1;
                for (d = 0; d < t[r].length; d++) {
                    o = n / l;
                    if (o < r) {
                        n = o;
                        a = t[r][d];
                        break;
                    }
                    l *= r;
                }
            }
            var p = e.format_number(n);
            var v;
            if (p && a) v = [ p, a ]; else v = [ p ];
            if (!i) v = v.join(" ");
            return v;
        }
        var W = {
            1e3: [ null, "KB", "MB", "GB", "TB", "PB", "EB", "ZB" ],
            1024: [ null, "KiB", "MiB", "GiB", "TiB", "PiB", "EiB", "ZiB" ]
        };
        e.format_bytes = function Ge(e, n, t) {
            if (n === undefined) n = 1024;
            return z(e, W, n, t);
        };
        e.get_byte_units = function He(e, n) {
            if (n === undefined || !(n in W)) n = 1024;
            function t(e) {
                return {
                    name: W[n][e],
                    factor: Math.pow(n, e)
                };
            }
            var r = [ t(2), t(3), t(4) ];
            for (var i = r.length - 1; i >= 0; i--) {
                if (i === 0 || e / r[i].factor >= 10) {
                    r[i].selected = true;
                    break;
                }
            }
            return r;
        };
        var V = {
            1024: [ "B/s", "KiB/s", "MiB/s", "GiB/s", "TiB/s", "PiB/s", "EiB/s", "ZiB/s" ]
        };
        e.format_bytes_per_sec = function Ke(e, n, t) {
            if (n === undefined) n = 1024;
            return z(e, V, n, t);
        };
        var Z = {
            1e3: [ "bps", "Kbps", "Mbps", "Gbps", "Tbps", "Pbps", "Ebps", "Zbps" ]
        };
        e.format_bits_per_sec = function ze(e, n, t) {
            if (n === undefined) n = 1e3;
            return z(e, Z, n, t);
        };
        function F(n) {
            var t = this;
            t.prefixedKey = function(n) {
                return e.transport.application() + ":" + n;
            };
            t.getItem = function(e, r) {
                var i = n.getItem(t.prefixedKey(e));
                if (!i && r) i = n.getItem(e);
                return i;
            };
            t.setItem = function(e, r, i) {
                n.setItem(t.prefixedKey(e), r);
                if (i) n.setItem(e, r);
            };
            t.removeItem = function(e, r) {
                n.removeItem(t.prefixedKey(e));
                if (r) n.removeItem(e);
            };
            t.clear = function(t) {
                var r = 0;
                while (r < n.length) {
                    var i = n.key(r);
                    if (t && i.indexOf("cockpit") !== 0) n.removeItem(i); else if (i.indexOf(e.transport.application()) === 0) n.removeItem(i); else r++;
                }
            };
        }
        e.localStorage = new F(window.localStorage);
        e.sessionStorage = new F(window.sessionStorage);
        function Y(e) {
            var n;
            if (e.parent && e.parent !== e) n = Y(e.parent);
            if (!n) {
                try {
                    n = e["cv1-storage"];
                    if (!n) e["cv1-storage"] = n = {};
                } catch (t) {}
            }
            return n;
        }
        function Q(n, t, r) {
            var i = this;
            var o = e.transport.application() + ":" + n;
            var a = window.sessionStorage;
            var s;
            var f = Y(window);
            var l = false;
            var u;
            function c() {
                if (f[o] !== undefined) {
                    if (r(f[o], n) === false) i.close();
                }
            }
            function d(e) {
                if (u && !l) l = true;
                if (!l) return;
                var n = Math.floor(Math.random() * 1e7) + 1;
                var t = document.createEvent("StorageEvent");
                t.initStorageEvent("storage", false, false, o, null, n, window.location, a);
                f[o] = e;
                a.setItem(o, n);
                t.self = i;
                window.dispatchEvent(t);
            }
            i.claim = function h() {
                if (!u) u = t(d, n);
            };
            function p() {
                if (u && u.close) u.close();
                u = null;
                if (!l) return;
                l = false;
                var e = a.getItem(o);
                if (e) e = parseInt(e, 10); else e = null;
                if (s && s === e) {
                    var n = document.createEvent("StorageEvent");
                    var t = a[o];
                    n.initStorageEvent("storage", false, false, o, t, null, window.location, a);
                    delete f[o];
                    a.removeItem(o);
                    n.self = i;
                    window.dispatchEvent(n);
                }
            }
            function v(e) {
                if (e.key !== o) return;
                if (e.self !== i) {
                    if (!e.newValue && !l) {
                        i.claim();
                        return;
                    }
                } else if (l && !e.oldValue && e.newValue !== a.getItem(o)) {
                    p();
                }
                var n = null;
                if (e.newValue) n = parseInt(e.newValue, 10);
                if (s !== n) {
                    s = n;
                    c();
                }
            }
            i.close = function() {
                window.removeEventListener("storage", v, true);
                p();
            };
            window.addEventListener("storage", v, true);
            window.addEventListener("beforeunload", function() {
                i.close();
            });
            window.addEventListener("unload", function() {
                i.close();
            });
            if (a.getItem(o)) c(); else i.claim();
        }
        e.cache = function We(e, n, t) {
            return new Q(e, n, t);
        };
        function X(e, n, t) {
            var r = this;
            r.interval = e;
            r.limit = n ? 64 * 1024 : 1024;
            var i = f(n);
            var o = 0;
            var a = null;
            var s = null;
            function f(e) {
                if (!e) return [];
                var n = Y(window);
                var t = n[e];
                if (!t) n[e] = t = [];
                return t;
            }
            function l(e, n) {
                var t = 0;
                var r = e.length - 1;
                var i, o;
                while (t <= r) {
                    i = (t + r) / 2 | 0;
                    o = e[i].beg;
                    if (o < n) t = i + 1; else if (o > n) r = i - 1; else return i;
                }
                return t;
            }
            function u(e, n, r) {
                if (t) {
                    if (!r) {
                        c(e, new Array(n - e), {});
                    }
                    t(e, n, r);
                }
            }
            r.load = function v(e, n, t) {
                if (n <= e) return;
                var r = l(i, e);
                var o;
                var a, s, f, c, d, v = i.length;
                var h = e;
                var m = [];
                for (d = r > 0 ? r - 1 : r; d < v; d++) {
                    o = i[d];
                    c = o.items.length;
                    if (!c) continue;
                    f = o.beg;
                    a = Math.max(f, e);
                    s = Math.min(f + c, n);
                    if (a < s) {
                        if (a > h) m.push([ h, a ]);
                        p(a, o.items.slice(a - f, s - f), o.mapping);
                        h = s;
                    } else if (d >= r) {
                        break;
                    }
                }
                for (d = 0; d < m.length; d++) u(m[d][0], m[d][1], t);
                if (h != n) u(h, n, t);
            };
            function c(e, n, t) {
                if (!n.length) return;
                var f = l(i, e);
                var u = e + n.length;
                var c = [];
                var d;
                var p;
                var v, h, m, g, w, b = i.length;
                for (w = f > 0 ? f - 1 : f; w < b; w++) {
                    d = i[w];
                    g = d.items.length;
                    if (!g) continue;
                    m = d.beg;
                    v = Math.max(m, e);
                    h = Math.min(m + g, u);
                    if (v < h) {
                        p = h - v;
                        d.items.splice(v - m, p);
                        o -= p;
                        if (v - m === 0) d.beg += h - m;
                    } else if (w >= f) {
                        break;
                    }
                }
                d = {
                    beg: e,
                    items: n,
                    mapping: t
                };
                if (!a) a = d;
                if (s) s.next = d;
                s = d;
                o += n.length;
                i.splice(f, 0, d);
                for (f--; f <= w; f++) {
                    d = i[f];
                    if (d && !d.items.length) {
                        i.splice(f, 1);
                        f--;
                    }
                }
                while (a && o > r.limit) {
                    o -= a.items.length;
                    a.items = [];
                    a.mapping = null;
                    a = a.next || null;
                }
                b = i.length;
                for (w = 0; w < b; w++) {
                    if (i[w].items.length > 0) break;
                }
                i.splice(0, w);
            }
            var d = {};
            r._register = function h(n, t) {
                if (n.interval != e) throw "mismatched metric interval between grid and sink";
                var r = d[t];
                if (!r) {
                    r = d[t] = {
                        grid: n,
                        links: []
                    };
                    r.links.remove = function i() {
                        delete d[t];
                    };
                }
                return r.links;
            };
            function p(e, n, t) {
                var r, i, o, a, s;
                var f, l, u, c;
                var p, v, h;
                var m, g, w, b, y;
                var k = e + n.length;
                for (p in d) {
                    v = d[p];
                    h = v.grid;
                    b = Math.max(e, h.beg);
                    y = Math.min(k, h.end);
                    if (b < y) {
                        m = b - e;
                        g = b - h.beg;
                        w = y - b;
                        for (r = 0; r < w; r++) {
                            s = v.links.length;
                            for (a = 0; a < s; a++) {
                                l = v.links[a][0];
                                u = v.links[a][1];
                                f = n[m + r];
                                c = t;
                                o = l.length;
                                for (i = 0; f !== undefined && i < o; i++) {
                                    if (!f) {
                                        f = undefined;
                                    } else if (c !== undefined && c !== null) {
                                        c = c[l[i]];
                                        if (c) f = f[c[""]]; else f = f[l[i]];
                                    } else {
                                        f = f[l[i]];
                                    }
                                }
                                u[g + r] = f;
                            }
                        }
                        h.notify(g, w);
                    }
                }
            }
            r.input = function m(e, n, t) {
                p(e, n, t);
                c(e, n, t);
            };
        }
        e.series = function Ve(e, n, t) {
            return new X(e, n, t);
        };
        var ee = 1;
        function ne(e, n, t) {
            var o = this;
            j(o, {});
            var s = [];
            o.interval = e;
            o.beg = 0;
            o.end = 0;
            var f = [];
            var l = [];
            var u = 0;
            var c = "g1-" + ee;
            ee += 1;
            var d = null;
            var p = null;
            o.notify = function m(e, n) {
                if (u) return;
                if (e + n > o.end - o.beg) n = o.end - o.beg - e;
                if (n <= 0) return;
                var t, r = f.length;
                var i, a;
                for (t = 0; t < r; t++) {
                    i = f[t][0];
                    a = f[t][1];
                    i.call(o, a, e, n);
                }
                o.dispatchEvent("notify", e, n);
            };
            o.add = function g() {
                var e = [];
                s.push(e);
                var n, t, a, u, d;
                if (i(arguments[0])) {
                    t = arguments[0];
                    t = t["series"] || t;
                    a = arguments[1];
                    if (!a) a = []; else if (typeof a === "string") a = a.split(".");
                    u = t._register(o, c);
                    if (!u.length) l.push({
                        sink: t,
                        links: u
                    });
                    u.push([ a, e ]);
                } else if (r(arguments[0])) {
                    d = [ arguments[0], e ];
                    if (arguments[1] === true) f.unshift(d); else f.push(d);
                } else if (arguments.length !== 0) {
                    throw "invalid args to grid.add()";
                }
                return e;
            };
            o.remove = function w(e) {
                var n, t, r, i;
                r = l.length;
                for (t = 0; t < r; t++) {
                    i = l[t].links.length;
                    for (n = 0; n < i; n++) {
                        if (l[t].links[n][1] === e) {
                            l[t].links.splice(n, 1);
                            break;
                        }
                    }
                }
                r = s.length;
                for (t = 0; t < r; t++) {
                    if (s[t] === e) {
                        s.splice(t, 1);
                        break;
                    }
                }
            };
            o.sync = function b(e) {
                u++;
                var n, t, r = l.length;
                for (t = 0; t < r; t++) {
                    n = l[t].sink;
                    n.load(o.beg, o.end, e);
                }
                u--;
                o.notify(0, o.end - o.beg);
            };
            function v(e, n, t) {
                if (n === undefined) n = e + (o.end - o.beg);
                if (n < e) e = n;
                o.beg = e;
                o.end = n;
                if (!s.length) return;
                s.forEach(function(e) {
                    e.length = 0;
                });
                o.sync(t);
            }
            function h() {
                window.clearInterval(d);
                d = null;
                p = null;
            }
            o.move = function y(e, n) {
                h();
                var t = null;
                if (e === undefined) {
                    e = 0;
                } else if (a(e)) {
                    t = Date.now();
                    e = Math.floor(t / o.interval) + e;
                }
                if (n !== undefined && a(n)) {
                    if (t === null) t = Date.now();
                    n = Math.floor(t / o.interval) + n;
                }
                v(e, n, false);
            };
            o.walk = function k() {
                var e = Date.now();
                if (o.interval > 2e9) return;
                h();
                p = e - o.beg * o.interval;
                d = window.setInterval(function() {
                    var e = Date.now();
                    v(Math.floor((e - p) / o.interval), undefined, true);
                }, o.interval);
            };
            o.close = function _() {
                h();
                while (l.length) l.pop().links.remove();
            };
            o.move(n, t);
        }
        e.grid = function Ze(e, n, t) {
            return new ne(e, n, t);
        };
        function te(n, t) {
            this.problem = n;
            this.message = t || e.message(n);
            this.toString = function() {
                return this.message;
            };
        }
        e.logout = function Fe(n) {
            e.sessionStorage.clear(true);
            e.localStorage.removeItem("login-data", true);
            e.localStorage.clear(false);
            if (n !== false) c = true;
            B(function(e) {
                e.send_control({
                    command: "logout",
                    disconnect: true
                });
            });
            window.sessionStorage.setItem("logout-intent", "explicit");
        };
        e.drop_privileges = function Ye() {
            B(function(e) {
                e.send_control({
                    command: "logout",
                    disconnect: false
                });
            });
        };
        e.info = {};
        j(e.info, {});
        p = function(n) {
            if (n.system) s(e.info, n.system);
            if (n.system) e.info.dispatchEvent("changed");
        };
        var re = null;
        e.user = function() {
            var n = e.defer();
            var t;
            if (!re) {
                t = e.dbus(null, {
                    bus: "internal"
                });
                t.call("/user", "org.freedesktop.DBus.Properties", "GetAll", [ "cockpit.User" ], {
                    type: "s"
                }).done(function(e) {
                    var t = e[0];
                    n.resolve({
                        id: t.Id.v,
                        name: t.Name.v,
                        full_name: t.Full.v,
                        groups: t.Groups.v,
                        home: t.Home.v,
                        shell: t.Shell.v
                    });
                }).fail(function(e) {
                    n.reject(e);
                }).always(function() {
                    t.close();
                });
            } else {
                n.resolve(re);
            }
            return n.promise;
        };
        document.addEventListener("click", function(e) {
            if (n(e.target.classList, "disabled")) e.stopPropagation();
        }, true);
        var ie = null;
        function oe() {
            return window.location.href.split("#")[1] || "";
        }
        function ae() {
            var n = this;
            var r = e.transport.application();
            n.url_root = url_root || "";
            if (r.indexOf("cockpit+=") === 0) {
                if (n.url_root) n.url_root += "/";
                n.url_root = n.url_root + r.replace("cockpit+", "");
            }
            var i = oe();
            var o = {};
            var a = l(i, o);
            function s(e) {
                var t = e.split("/").map(decodeURIComponent);
                var r, i, o = [];
                if (n.url_root) o = n.url_root.split("/").map(decodeURIComponent);
                if (e && e[0] !== "/") {
                    r = [].concat(a);
                    r.pop();
                    r = r.concat(t);
                } else {
                    r = t;
                }
                r = U(r);
                for (i = 0; i < o.length; i++) {
                    if (o[i] !== r[i]) break;
                }
                if (i == o.length) r.splice(0, o.length);
                return r;
            }
            function f(e, r, i) {
                if (typeof e == "string") e = s(e, n.path);
                var o = "/" + e.map(encodeURIComponent).join("/");
                if (i && n.url_root && o.indexOf("/" + n.url_root + "/" !== 0)) o = "/" + n.url_root + o;
                o = o.replace("%40", "@");
                o = o.replace("%3D", "=");
                var a, f, l, u = [];
                function c(e) {
                    u.push(encodeURIComponent(f) + "=" + encodeURIComponent(e));
                }
                if (r) {
                    for (f in r) {
                        l = r[f];
                        if (!t(l)) l = [ l ];
                        l.forEach(c);
                    }
                    if (u.length > 0) o += "?" + u.join("&");
                }
                return o;
            }
            function l(e, n) {
                if (e[0] == "#") e = e.substr(1);
                var r = e.indexOf("?");
                var i = e;
                if (r === -1) i = e; else i = e.substr(0, r);
                var o = s(i);
                if (r !== -1 && n) {
                    e.substring(r + 1).split("&").forEach(function(e) {
                        var r, i = e.split("=");
                        var o = decodeURIComponent(i[0]);
                        var a = decodeURIComponent(i[1]);
                        if (n.hasOwnProperty(o)) {
                            r = n[o];
                            if (!t(a)) r = n[o] = [ r ];
                            r.push(a);
                        } else {
                            n[o] = a;
                        }
                    });
                }
                return o;
            }
            function u() {
                var e;
                if (arguments.length == 1 && arguments[0] instanceof ae) {
                    e = String(arguments[0]);
                } else if (typeof arguments[0] == "string") {
                    var t = arguments[1] || {};
                    e = f(l(arguments[0], t), t);
                } else {
                    e = f.apply(n, arguments);
                }
                return e;
            }
            function c() {
                if (n !== ie) return;
                var e = u.apply(n, arguments);
                window.location.replace(window.location.pathname + "#" + e);
            }
            function d() {
                if (n !== ie) return;
                var e = u.apply(n, arguments);
                window.location.hash = "#" + e;
            }
            Object.defineProperties(n, {
                path: {
                    enumerable: true,
                    writable: false,
                    value: a
                },
                options: {
                    enumerable: true,
                    writable: false,
                    value: o
                },
                href: {
                    enumerable: true,
                    value: i
                },
                go: {
                    value: d
                },
                replace: {
                    value: c
                },
                encode: {
                    value: f
                },
                decode: {
                    value: l
                },
                toString: {
                    value: function() {
                        return i;
                    }
                }
            });
        }
        Object.defineProperty(e, "location", {
            enumerable: true,
            get: function() {
                if (!ie || ie.href !== oe()) ie = new ae();
                return ie;
            },
            set: function(n) {
                e.location.go(n);
            }
        });
        window.addEventListener("hashchange", function() {
            ie = null;
            e.dispatchEvent("locationchanged");
        });
        e.jump = function Qe(n, r) {
            if (t(n)) n = "/" + n.map(encodeURIComponent).join("/").replace("%40", "@").replace("%3D", "="); else n = "" + n;
            var i = {
                command: "jump",
                location: n,
                host: r
            };
            e.transport.inject("\n" + JSON.stringify(i));
        };
        (function() {
            var n;
            var t = false;
            function r() {
                var r = document[n];
                if (!n || typeof r === "undefined") r = false;
                if (r === false) r = t;
                if (e.hidden !== r) {
                    e.hidden = r;
                    e.dispatchEvent("visibilitychange");
                }
            }
            if (typeof document.hidden !== "undefined") {
                n = "hidden";
                document.addEventListener("visibilitychange", r);
            } else if (typeof document.mozHidden !== "undefined") {
                n = "mozHidden";
                document.addEventListener("mozvisibilitychange", r);
            } else if (typeof document.msHidden !== "undefined") {
                n = "msHidden";
                document.addEventListener("msvisibilitychange", r);
            } else if (typeof document.webkitHidden !== "undefined") {
                n = "webkitHidden";
                document.addEventListener("webkitvisibilitychange", r);
            }
            h = function(e) {
                if ("hidden" in e) {
                    t = e.hidden;
                    r();
                }
            };
            r();
        })();
        function se(n, t) {
            this.problem = n.problem || null;
            this.exit_status = n["exit-status"];
            if (this.exit_status === undefined) this.exit_status = null;
            this.exit_signal = n["exit-signal"];
            if (this.exit_signal === undefined) this.exit_signal = null;
            this.message = n.message;
            if (this.message === undefined) {
                if (this.problem) this.message = e.message(n.problem); else if (this.exit_signal !== null) this.message = e.format(we("$0 killed with signal $1"), t, this.exit_signal); else if (this.exit_status !== undefined) this.message = e.format(we("$0 exited with code $1"), t, this.exit_status); else this.message = e.format(we("$0 failed"), t);
            } else {
                this.message = this.message.trim();
            }
            this.toString = function() {
                return this.message;
            };
        }
        function fe() {
            if (window.debugging == "all" || window.debugging == "spawn") console.debug.apply(console, arguments);
        }
        e.spawn = function(n, t) {
            var r = e.defer();
            var i = {
                payload: "stream",
                spawn: []
            };
            if (n instanceof Array) {
                for (var o = 0; o < n.length; o++) i["spawn"].push(String(n[o]));
            } else {
                i["spawn"].push(String(n));
            }
            if (t !== undefined) s(i, t);
            var a = i["spawn"][0] || "process";
            var f = e.channel(i);
            var l = f.buffer(null);
            f.addEventListener("close", function(e, n) {
                var t = l.squash();
                fe("process closed:", JSON.stringify(n));
                if (t) fe("process output:", t);
                if (n.message !== undefined) fe("process error:", n.message);
                if (n.problem) r.reject(new se(n, a)); else if (n["exit-status"] || n["exit-signal"]) r.reject(new se(n, a), t); else if (n.message !== undefined) r.resolve(t, n.message); else r.resolve(t);
            });
            var u = r.promise;
            u.stream = function(e) {
                l.callback = e;
                return this;
            };
            u.input = function(e, n) {
                if (e !== null && e !== undefined) {
                    fe("process input:", e);
                    f.send(e);
                }
                if (!n) f.control({
                    command: "done"
                });
                return this;
            };
            u.close = function(e) {
                fe("process closing:", e);
                if (f.valid) f.close(e);
                return this;
            };
            return u;
        };
        e.script = function(n, t, r) {
            if (!r && o(t)) {
                r = t;
                t = [];
            }
            var i = [ "/bin/sh", "-c", n, "--" ];
            i.push.apply(i, t);
            return e.spawn(i, r);
        };
        function le() {
            if (window.debugging == "all" || window.debugging == "dbus") console.debug.apply(console, arguments);
        }
        function ue(n) {
            if (typeof n == "string") {
                this.problem = n;
                this.name = null;
                this.message = e.message(n);
            } else {
                this.problem = null;
                this.name = n[0];
                this.message = n[1][0] || n[0];
            }
            this.toString = function() {
                return this.message;
            };
        }
        function ce() {
            var e = this;
            var n = [];
            e.data = {};
            e.meta = {};
            e.connect = function r(e, t, i, o) {
                var a = [ e, t, i ];
                if (o) n.unshift(a); else n.push(a);
                return {
                    remove: function s() {
                        var r, o = n.length;
                        for (r = 0; r < o; r++) {
                            var a = n[r];
                            if (a[0] === e && a[1] === t && a[2] === i) {
                                delete a[r];
                                break;
                            }
                        }
                    }
                };
            };
            function t(e, t, r) {
                var i = n.slice();
                var o, a = i.length;
                for (o = 0; o < a; o++) {
                    var s = i[o];
                    if ((!s[0] || s[0] === e) && (!s[1] || s[1] === t)) {
                        s[2](r, e);
                    }
                }
            }
            e.update = function i(n, r, o) {
                if (!e.data[n]) e.data[n] = {};
                if (!e.data[n][r]) e.data[n][r] = o; else o = s(e.data[n][r], o);
                t(n, r, o);
            };
            e.remove = function o(n, r) {
                if (e.data[n]) {
                    delete e.data[n][r];
                    t(n, r, null);
                }
            };
            e.lookup = function a(n, t) {
                if (e.data[n]) return e.data[n][t];
                return undefined;
            };
            e.each = function f(n, t) {
                var r, i;
                for (r in e.data) {
                    for (n in e.data[r]) {
                        if (i == n) t(e.data[r][n], r);
                    }
                }
            };
            e.close = function l() {
                e.data = {};
                var t = n;
                n = [];
                var r, i = t.length;
                for (r = 0; r < i; r++) t[r].callback();
            };
        }
        function de(n, t, r, i, o) {
            var a = this;
            j(a, {});
            var f = false;
            var l = false;
            var u = e.defer();
            Object.defineProperties(a, {
                client: {
                    value: n,
                    enumerable: false,
                    writable: false
                },
                path: {
                    value: i,
                    enumerable: false,
                    writable: false
                },
                iface: {
                    value: r,
                    enumerable: false,
                    writable: false
                },
                valid: {
                    get: function() {
                        return f;
                    },
                    enumerable: false
                },
                wait: {
                    enumerable: false,
                    writable: false,
                    value: function(e) {
                        if (e) u.promise.always(e);
                        return u.promise;
                    }
                },
                call: {
                    value: function(e, t) {
                        return n.call(i, r, e, t);
                    },
                    enumerable: false,
                    writable: false
                },
                data: {
                    value: {},
                    enumerable: false
                }
            });
            if (typeof window.$ === "function") {
                Object.defineProperty(a, window.$.expando, {
                    value: {},
                    writable: true,
                    enumerable: false
                });
            }
            if (!o) o = {};
            function c() {
                if (!t.meta[r]) return;
                var o = t.meta[r];
                l = true;
                Object.keys(o.methods || {}).forEach(function(t) {
                    if (t[0].toLowerCase() == t[0]) return;
                    Object.defineProperty(a, t, {
                        enumerable: false,
                        value: function() {
                            var o = e.defer();
                            n.call(i, r, t, Array.prototype.slice.call(arguments)).done(function(e) {
                                o.resolve.apply(o, e);
                            }).fail(function(e) {
                                o.reject(e);
                            });
                            return o.promise;
                        }
                    });
                });
                Object.keys(o.properties || {}).forEach(function(t) {
                    if (t[0].toLowerCase() == t[0]) return;
                    var s = {
                        enumerable: true,
                        get: function() {
                            return a.data[t];
                        },
                        set: function(e) {
                            throw t + "is not writable";
                        }
                    };
                    var f = o.properties[t];
                    if (f.flags && f.flags.indexOf("w") !== -1) {
                        s.set = function(o) {
                            n.call(i, "org.freedesktop.DBus.Properties", "Set", [ r, t, e.variant(f.type, o) ]).fail(function(e) {
                                console.log("Couldn't set " + r + " " + t + " at " + i + ": " + e);
                            });
                        };
                    }
                    Object.defineProperty(a, t, s);
                });
            }
            function d(e) {
                if (e) {
                    s(a.data, e);
                    if (!l) c();
                    f = true;
                } else {
                    f = false;
                }
                a.dispatchEvent("changed", e);
            }
            t.connect(i, r, d, true);
            d(t.lookup(i, r));
            function p(e, n, t, r) {
                a.dispatchEvent("signal", t, r);
                if (t[0].toLowerCase() != t[0]) {
                    r = r.slice();
                    r.unshift(t);
                    a.dispatchEvent.apply(a, r);
                }
            }
            n.subscribe({
                path: i,
                "interface": r
            }, p, o.subscribe !== false);
            function v(e) {
                if (f) u.resolve(); else u.reject(e);
            }
            if (o.watch !== false) n.watch({
                path: i,
                "interface": r
            }).always(v); else v();
        }
        function pe(n, t, r, i, o) {
            var a = this;
            j(a, {});
            var f;
            Object.defineProperties(a, {
                client: {
                    value: n,
                    enumerable: false,
                    writable: false
                },
                iface: {
                    value: r,
                    enumerable: false,
                    writable: false
                },
                path_namespace: {
                    value: i,
                    enumerable: false,
                    writable: false
                },
                wait: {
                    enumerable: false,
                    writable: false,
                    value: function(e) {
                        if (e) f.always(e);
                        return f;
                    }
                }
            });
            if (typeof window.$ === "function") {
                Object.defineProperty(a, window.$.expando, {
                    value: {},
                    writable: true,
                    enumerable: false
                });
            }
            var l = {
                "interface": r,
                path_namespace: i
            };
            n.subscribe(l);
            if (o.watch !== false) {
                f = n.watch(l);
            } else {
                f = e.defer().resolve().promise;
            }
            o = s({
                watch: false,
                subscribe: false
            }, o);
            function u(e, t) {
                var i = a[t];
                if (!t) {
                    return;
                } else if (!e && i) {
                    delete a[t];
                    a.dispatchEvent("removed", i);
                } else if (e) {
                    if (!i) {
                        i = a[t] = n.proxy(r, t, o);
                        a.dispatchEvent("added", i);
                    }
                    a.dispatchEvent("changed", i);
                }
            }
            t.connect(null, r, u, false);
            t.each(r, u);
        }
        function ve(n, t) {
            var r = this;
            j(r, {});
            var i = {};
            var a = false;
            var f = null;
            if (t) {
                if (t.track) a = true;
                delete t["track"];
                s(i, t);
            }
            i.payload = "dbus-json3";
            i.name = n;
            r.options = t;
            le("dbus open: ", i);
            var l = e.channel(i);
            var u = {};
            var c = {};
            var d;
            var p;
            r.constructors = {
                "*": de
            };
            function v() {
                if (!d) d = new ce();
            }
            function h(e, n) {
                if (n.path && e[0] !== n.path) return false;
                if (n.path_namespace && e[0].indexOf(n.path_namespace) !== 0) return false;
                if (n["interface"] && e[1] !== n["interface"]) return false;
                if (n.member && e[2] !== n.member) return false;
                if (n.arg0 && e[3] !== n.arg0) return false;
                return true;
            }
            function m(e, n) {
                le("dbus:", n);
                var t;
                try {
                    t = JSON.parse(n);
                } catch (i) {
                    console.warn("received invalid dbus json message:", i);
                }
                if (t === undefined) {
                    l.close({
                        problem: "protocol-error"
                    });
                    return;
                }
                var o, s;
                if (t.id !== undefined) o = c[t.id];
                if (t.reply) {
                    if (o) {
                        s = {};
                        if (t.type) s.type = t.type;
                        if (t.flags) s.flags = t.flags;
                        o.resolve(t.reply[0] || [], s);
                        delete c[t.id];
                    }
                    return;
                } else if (t.error) {
                    if (o) {
                        o.reject(new ue(t.error));
                        delete c[t.id];
                    }
                    return;
                }
                A(function() {
                    var e, i;
                    if (t.signal) {
                        for (e in u) {
                            i = u[e];
                            if (i.callback) {
                                if (h(t.signal, i.match)) i.callback.apply(r, t.signal);
                            }
                        }
                    } else if (t.notify) {
                        w(t.notify);
                    } else if (t.meta) {
                        g(t.meta);
                    } else if (t.owner !== undefined) {
                        r.dispatchEvent("owner", t.owner);
                        if (a && f) r.close();
                        f = t.owner;
                    } else {
                        le("received unexpected dbus json message:", n);
                    }
                });
            }
            function g(e) {
                v();
                s(d.meta, e);
                r.dispatchEvent("meta", e);
            }
            function w(e) {
                v();
                var n, t, i;
                for (n in e) {
                    for (t in e[n]) {
                        i = e[n][t];
                        if (!i) d.remove(n, t); else d.update(n, t, i);
                    }
                }
                r.dispatchEvent("notify", e);
            }
            this.notify = w;
            function b(e) {
                p = e.problem || "disconnected";
                var n, t = c;
                c = {};
                for (n in t) {
                    t[n].reject(new ue(p));
                }
                r.dispatchEvent("close", e);
            }
            this.close = function _(e) {
                if (typeof e == "string") e = {
                    problem: e
                };
                if (!e) e = {};
                if (l) l.close(e); else b(e);
            };
            function y(e, n) {
                le("dbus close:", n);
                l.removeEventListener("message", m);
                l.removeEventListener("close", y);
                l = null;
                b(n);
            }
            l.addEventListener("message", m);
            l.addEventListener("close", y);
            var k = 1;
            this.call = function x(n, t, r, i, o) {
                var a = e.defer();
                var s = String(k);
                k++;
                var f = {
                    call: [ n, t, r, i || [] ],
                    id: s
                };
                if (o) {
                    if (o.type) f.type = o.type;
                    if (o.flags !== undefined) f.flags = o.flags;
                }
                var u = JSON.stringify(f);
                le("dbus:", u);
                if (l) {
                    l.send(u);
                    c[s] = a;
                } else {
                    a.reject(new ue(p));
                }
                return a.promise;
            };
            this.subscribe = function E(e, n, t) {
                var r = {
                    match: e || {},
                    callback: n
                };
                if (t !== false && l && l.valid) {
                    var i = JSON.stringify({
                        "add-match": r.match
                    });
                    le("dbus:", i);
                    l.send(i);
                }
                var o;
                if (n) {
                    o = String(k);
                    k++;
                    u[o] = r;
                }
                return {
                    remove: function() {
                        var e;
                        if (o) {
                            e = u[o];
                            if (e) delete u[o];
                        }
                        if (t !== false && l && l.valid && e) {
                            var n = JSON.stringify({
                                "remove-match": e.match
                            });
                            le("dbus:", n);
                            l.send(n);
                        }
                    }
                };
            };
            r.watch = function S(n) {
                var t;
                if (o(n)) t = n; else t = {
                    path: String(n)
                };
                var r = String(k);
                k++;
                var i = e.defer();
                c[r] = i;
                var a = JSON.stringify({
                    watch: t,
                    id: r
                });
                if (l && l.valid) {
                    le("dbus:", a);
                    l.send(a);
                } else {
                    i.reject(new ue(p));
                }
                var s = i.promise;
                s.remove = function f() {
                    delete c[r];
                    if (l && l.valid) {
                        a = JSON.stringify({
                            unwatch: t
                        });
                        le("dbus:", a);
                        l.send(a);
                    }
                };
                return s;
            };
            r.proxy = function O(e, t, i) {
                if (!e) e = n;
                e = String(e);
                if (!t) t = "/" + e.replace(/\./g, "/");
                var o = r.constructors[e];
                if (!o) o = r.constructors["*"];
                if (!i) i = {};
                v();
                return new o(r, d, e, String(t), i);
            };
            r.proxies = function C(e, t, i) {
                if (!e) e = n;
                if (!t) t = "/";
                if (!i) i = {};
                v();
                return new pe(r, d, String(e), String(t), i);
            };
        }
        e.dbus = function Xe(e, n) {
            return new ve(e, n);
        };
        e.variant = function en(e, n) {
            return {
                v: n,
                t: e
            };
        };
        e.byte_array = function nn(e) {
            return window.btoa(e);
        };
        e.file = function tn(n, t) {
            t = t || {};
            var r = t.binary;
            var i = {
                path: n,
                read: d,
                replace: v,
                modify: h,
                watch: _,
                close: x
            };
            var o = s({}, t);
            delete o.syntax;
            function a(e) {
                if (t.syntax && t.syntax.parse) return t.syntax.parse(e); else return e;
            }
            function l(e) {
                if (t.syntax && t.syntax.stringify) return t.syntax.stringify(e); else return e;
            }
            var u = null;
            var c;
            function d() {
                if (u) return u;
                var t = e.defer();
                var i = s({}, o, {
                    payload: "fsread1",
                    path: n
                });
                function f() {
                    c = e.channel(i);
                    var n = [];
                    c.addEventListener("message", function(e, t) {
                        n.push(t);
                    });
                    c.addEventListener("close", function(e, i) {
                        c = null;
                        if (i.problem == "change-conflict") {
                            f();
                            return;
                        }
                        u = null;
                        if (i.problem) {
                            var o = new te(i.problem, i.message);
                            k(null, null, o);
                            t.reject(o);
                            return;
                        }
                        var s;
                        if (i.tag == "-") s = null; else {
                            try {
                                s = a(I(n, r));
                            } catch (l) {
                                k(null, null, l);
                                t.reject(l);
                                return;
                            }
                        }
                        k(s, i.tag);
                        t.resolve(s, i.tag);
                    });
                }
                f();
                u = t.promise;
                return u;
            }
            var p = null;
            function v(t, r) {
                var i = e.defer();
                var a;
                try {
                    if (t === null) a = null; else a = l(t);
                } catch (f) {
                    i.reject(f);
                    return i.promise;
                }
                if (p) p.close("abort");
                var u = s({}, o, {
                    payload: "fsreplace1",
                    path: n,
                    tag: r
                });
                p = e.channel(u);
                p.addEventListener("close", function(e, n) {
                    p = null;
                    if (n.problem) {
                        i.reject(new te(n.problem, n.message));
                    } else {
                        k(t, n.tag);
                        i.resolve(n.tag);
                    }
                });
                var c = 0, d = false;
                if (a) {
                    if (a.byteLength) {
                        c = a.byteLength;
                        d = true;
                    } else if (a.length) {
                        c = a.length;
                    }
                }
                var v, h, m = 16 * 1024;
                for (v = 0; v < c; v += m) {
                    h = Math.min(c - v, m);
                    if (d) p.send(new window.Uint8Array(a.buffer, v, h)); else p.send(a.substr(v, h));
                }
                p.control({
                    command: "done"
                });
                return i.promise;
            }
            function h(n, t, r) {
                var i = e.defer();
                function o(e, t) {
                    var r = n(e);
                    if (r === undefined) r = e;
                    v(r, t).done(function(e) {
                        i.resolve(r, e);
                    }).fail(function(e) {
                        if (e.problem == "change-conflict") a(); else i.reject(e);
                    });
                }
                function a() {
                    d().done(o).fail(function(e) {
                        i.reject(e);
                    });
                }
                if (t === undefined) a(); else o(t, r);
                return i.promise;
            }
            var m = [];
            var g = 0;
            var w = null;
            var b;
            function y() {
                if (g > 0) {
                    if (w) return;
                    var t = s({}, o, {
                        payload: "fswatch1",
                        path: n
                    });
                    w = e.channel(t);
                    w.addEventListener("message", function(e, t) {
                        var r;
                        try {
                            r = JSON.parse(t);
                        } catch (i) {
                            r = null;
                        }
                        if (r && r.path == n && r.tag && r.tag != b) d();
                    });
                } else {
                    if (w) {
                        w.close();
                        w = null;
                    }
                }
            }
            function k() {
                b = arguments[1] || null;
                f(m, i, arguments);
            }
            function _(e) {
                if (e) m.push(e);
                g += 1;
                y();
                b = null;
                d();
                return {
                    remove: function() {
                        var n;
                        if (e) {
                            n = m.indexOf(e);
                            if (n > -1) m[n] = null;
                        }
                        g -= 1;
                        y();
                    }
                };
            }
            function x() {
                if (c) c.close("cancelled");
                if (p) p.close("cancelled");
                if (w) w.close("cancelled");
            }
            return i;
        };
        var he = {};
        var me;
        e.language = undefined;
        e.locale = function rn(n) {
            var t = e.language || "en";
            var r;
            if (n) {
                s(he, n);
                r = n[""];
            } else if (n === null) {
                he = {};
            }
            if (r) {
                if (r["plural-forms"]) me = r["plural-forms"];
                if (r["language"]) t = r["language"];
            }
            e.language = t;
        };
        e.translate = function on() {
            var n;
            if (arguments.length === 0) n = [ document ]; else if (arguments.length === 1 && arguments[0].length) n = arguments[0]; else n = arguments;
            var t, r, i, o, a, s, f, l, u, c;
            for (t = 0, r = n.length; t < r; t++) {
                l = null;
                if (n[t].querySelectorAll) l = n[t].querySelectorAll("[translatable], [translate]");
                if (!l) continue;
                for (o = 0, a = l.length; o < a; o++) {
                    c = l[o];
                    i = c.getAttribute("translate") || c.getAttribute("translatable") || "yes";
                    if (i == "no") continue;
                    u = i.split(" ");
                    i = c.getAttribute("translate-context") || c.getAttribute("context");
                    for (s = 0, f = u.length; s < f; s++) {
                        if (u[s] == "yes" || u[s] == "translate") c.textContent = e.gettext(i, c.textContent); else if (u[s]) c.setAttribute(u[s], e.gettext(i, c.getAttribute(u[s]) || ""));
                    }
                    c.removeAttribute("translatable");
                    c.removeAttribute("translate");
                }
            }
        };
        e.gettext = function an(e, n) {
            if (arguments.length == 1) {
                n = e;
                e = undefined;
            }
            var t = e ? e + "" + n : n;
            if (he) {
                var r = he[t];
                if (r && r[1]) return r[1];
            }
            return n;
        };
        function ge(e) {
            return e === true ? 1 : e ? e : 0;
        }
        e.ngettext = function sn(e, n, t, r) {
            if (arguments.length == 3) {
                r = t;
                t = n;
                n = e;
                e = undefined;
            }
            var i = e ? e + "" + n : n;
            if (he && me) {
                var o = he[i];
                if (o) {
                    var a = ge(me(r)) + 1;
                    if (o[a]) return o[a];
                }
            }
            if (r == 1) return n;
            return t;
        };
        e.noop = function fn(e, n) {
            return arguments[arguments.length - 1];
        };
        var we = e.gettext;
        e.message = function ln(e) {
            if (e.message) return e.message;
            var n = null;
            if (e.problem) n = e.problem; else n = e + "";
            if (n == "terminated") return we("Your session has been terminated."); else if (n == "no-session") return we("Your session has expired. Please log in again."); else if (n == "access-denied") return we("Not permitted to perform this action."); else if (n == "authentication-failed") return we("Login failed"); else if (n == "authentication-not-supported") return we("The server refused to authenticate using any supported methods."); else if (n == "unknown-hostkey") return we("Untrusted host"); else if (n == "invalid-hostkey") return we("Host key is incorrect"); else if (n == "internal-error") return we("Internal error"); else if (n == "timeout") return we("Connection has timed out."); else if (n == "no-cockpit") return we("Cockpit is not installed on the system."); else if (n == "no-forwarding") return we("Cannot forward login credentials"); else if (n == "disconnected") return we("Server has closed the connection."); else if (n == "not-supported") return we("Cockpit is not compatible with the software on the system."); else if (n == "no-host") return we("Cockpit could not contact the given host."); else return n;
        };
        function be(e, n, t) {
            this.status = parseInt(e, 10);
            this.reason = n;
            this.message = t || n;
            this.problem = null;
            this.valueOf = function() {
                return this.status;
            };
            this.toString = function() {
                return this.status + " " + this.message;
            };
        }
        function ye() {
            if (window.debugging == "all" || window.debugging == "http") console.debug.apply(console, arguments);
        }
        function ke(e, n) {
            if (!e) return undefined;
            n = n.toLowerCase();
            for (var t in e) {
                if (t.toLowerCase() == n) return e[t];
            }
            return undefined;
        }
        function _e(n, r) {
            var i = this;
            i.options = r;
            r.payload = "http-stream1";
            var a = [];
            if (n !== undefined) {
                if (n.indexOf && n.indexOf("/") === 0) {
                    r.unix = n;
                } else {
                    var l = parseInt(n, 10);
                    if (!isNaN(l)) r.port = l; else throw "The endpoint must be either a unix path or port number";
                }
            }
            if (r.address) {
                if (!r.capabilities) r.capabilities = [];
                r.capabilities.push("address");
            }
            function u(e) {
                return Object.keys(e).map(function(n) {
                    return encodeURIComponent(n) + "=" + encodeURIComponent(e[n]);
                }).join("&").split("%20").join("+");
            }
            i.request = function c(n) {
                var t = e.defer();
                if (!n.path) n.path = "/";
                if (!n.method) n.method = "GET";
                if (n.params) {
                    if (n.path.indexOf("?") === -1) n.path += "?" + u(n.params); else n.path += "&" + u(n.params);
                }
                delete n.params;
                var o = n.body;
                delete n.body;
                var l = n.headers;
                delete n.headers;
                s(n, r);
                if (r.headers && l) n.headers = s({}, r.headers, l); else if (r.headers) n.headers = r.headers; else n.headers = l;
                ye("http request:", JSON.stringify(n));
                var c = e.channel(n);
                if (o !== undefined) {
                    if (o !== "") {
                        ye("http input:", o);
                        c.send(o);
                    }
                    ye("http done");
                    c.control({
                        command: "done"
                    });
                }
                var d = null;
                var p = null;
                var v = 0;
                var h = null;
                var m = c.buffer(function(n) {
                    v += 1;
                    if (v === 1) {
                        if (c.binary) n = e.utf8_decoder().decode(n);
                        h = JSON.parse(n);
                        if (p) {
                            h.headers = h.headers || {};
                            f(p, i, [ h.status, h.headers ]);
                        }
                        return true;
                    }
                    if (h.status >= 200 && h.status <= 299 && d) return d(n);
                    return 0;
                });
                function g(e, n) {
                    var r = a.indexOf(w);
                    if (r >= 0) a.splice(r, 1);
                    if (n.problem) {
                        ye("http problem: ", n.problem);
                        t.reject(new te(n.problem));
                    } else {
                        var i = m.squash();
                        if (h && (h.status < 200 || h.status > 299)) {
                            var o;
                            var s = ke(h.headers, "Content-Type");
                            if (s && !c.binary) {
                                if (s.indexOf("text/plain") === 0) o = i;
                            }
                            ye("http status: ", h.status);
                            t.reject(new be(h.status, h.reason, o), i);
                        } else {
                            ye("http done");
                            t.resolve(i);
                        }
                    }
                    c.removeEventListener("close", g);
                }
                c.addEventListener("close", g);
                var w = t.promise;
                w.stream = function(e) {
                    d = e;
                    return w;
                };
                w.response = function(e) {
                    if (p === null) p = [];
                    p.push(e);
                    return w;
                };
                w.input = function(e, n) {
                    if (e !== null && e !== undefined) {
                        ye("http input:", e);
                        c.send(e);
                    }
                    if (!n) {
                        ye("http done");
                        c.control({
                            command: "done"
                        });
                    }
                    return w;
                };
                w.close = function(e) {
                    ye("http closing:", e);
                    c.close(e);
                    return w;
                };
                a.push(w);
                return w;
            };
            i.get = function d(e, n, t) {
                return i.request({
                    method: "GET",
                    params: n,
                    path: e,
                    body: "",
                    headers: t
                });
            };
            i.post = function p(e, n, r) {
                r = r || {};
                if (o(n) || t(n)) {
                    n = JSON.stringify(n);
                    if (ke(r, "Content-Type") === undefined) r["Content-Type"] = "application/json";
                } else if (n === undefined || n === null) {
                    n = "";
                } else if (typeof n !== "string") {
                    n = String(n);
                }
                return i.request({
                    method: "POST",
                    path: e,
                    body: n,
                    headers: r
                });
            };
            i.close = function v(e) {
                var n = a.slice();
                for (var t = 0; t < n.length; t++) n[t].close(e);
            };
        }
        e.http = function(e, n) {
            if (o(e) && n === undefined) {
                n = e;
                e = undefined;
            }
            return new _e(e, n || {});
        };
        var xe = null;
        function Ee(n) {
            var t = this;
            j(t, {});
            t.allowed = null;
            t.user = n ? n.user : null;
            var r = null;
            var i = false;
            if (n) r = n.group;
            if (n && n.admin) i = true;
            function o(e) {
                if (e.id === 0) return true;
                if (e.groups) {
                    var n = false;
                    e.groups.forEach(function(e) {
                        if (e == r) {
                            n = true;
                            return false;
                        }
                        if (i && (e == "wheel" || e == "sudo")) {
                            n = true;
                            return false;
                        }
                    });
                    return n;
                }
                if (e.id === undefined) return null;
                return false;
            }
            if (t.user) {
                t.allowed = o(t.user);
            } else {
                e.user().done(function(e) {
                    t.user = e;
                    var n = o(e);
                    if (t.allowed !== n) {
                        t.allowed = n;
                        t.dispatchEvent("changed");
                    }
                });
            }
            t.close = function a() {};
        }
        e.permission = function un(e) {
            return new Ee(e);
        };
        function Se(e, n) {
            if (typeof e == "number") return e * n; else if (typeof e == "string") e = new Date(e);
            if (e instanceof Date) return e.getTime(); else throw "invalid date or offset";
        }
        function je(n, t, r) {
            var i = this;
            j(i, {});
            if (t.length === undefined) t = [ t ];
            var o = [];
            var a = false;
            i.series = e.series(n, r, f);
            i.archives = null;
            i.meta = null;
            function f(e, n, t) {
                if (!t) i.fetch(e, n); else i.follow();
            }
            function l(t, r, f) {
                if (t.length === 0) return;
                if (!f) {
                    if (a) return;
                    a = true;
                }
                var u = s({
                    payload: "metrics1",
                    interval: n,
                    source: "internal"
                }, t[0]);
                delete u.archive_source;
                var c = e.channel(u);
                o.push(c);
                var d = null;
                var p = null;
                var v;
                c.addEventListener("close", function(e, n) {
                    if (!f) a = false;
                    if (t.length > 1 && (n.problem == "not-supported" || n.problem == "not-found")) {
                        l(t.slice(1), r);
                    } else if (n.problem) {
                        if (n.problem != "terminated" && n.problem != "disconnected" && n.problem != "authentication-failed" && (n.problem != "not-found" || !f) && (n.problem != "not-supported" || !f)) {
                            console.warn("metrics channel failed: " + n.problem);
                        }
                    } else if (f) {
                        if (!i.archives) {
                            i.archives = true;
                            i.dispatchEvent("changed");
                        }
                    }
                });
                c.addEventListener("message", function(e, o) {
                    var a = JSON.parse(o);
                    var s, f, l, u, c, h, m;
                    var g, w, b;
                    var y;
                    var k = a.length;
                    if (k === undefined) {
                        d = a;
                        y = 0;
                        if (d.now && d.timestamp) y = d.timestamp + (Date.now() - d.now);
                        v = Math.floor(y / n);
                        r(v, d, null, t[0]);
                        i.meta = d;
                        i.dispatchEvent("changed");
                    } else if (d) {
                        for (g = 0; g < k; g++) {
                            s = a[g];
                            if (p) {
                                f = s.length;
                                l = p.length;
                                for (w = 0; w < l; w++) {
                                    u = s[w];
                                    if (u === null || u === undefined) {
                                        s[w] = p[w];
                                    } else {
                                        c = u.length;
                                        if (c !== undefined) {
                                            h = p[w];
                                            m = p[w].length;
                                            for (b = 0; b < c; b++) {
                                                if (u[b] === null) u[b] = h[b];
                                            }
                                            for (;b < m; b++) u[b] = h[b];
                                        }
                                    }
                                }
                            }
                            p = s;
                        }
                        r(v, d, a, t[0]);
                        v += k;
                        d.timestamp += n * k;
                    }
                });
            }
            function u(e, n, t, r) {
                var o, a, s;
                o = n.mapping;
                if (!o) {
                    o = {};
                    n.metrics.forEach(function(e, n) {
                        a = {
                            "": n
                        };
                        if (r.metrics_path_names) s = r.metrics_path_names[n]; else s = e.name;
                        o[s] = a;
                        if (e.instances) {
                            e.instances.forEach(function(e, n) {
                                if (e === "") e = "/";
                                a[e] = {
                                    "": n
                                };
                            });
                        }
                    });
                    n.mapping = o;
                }
                if (t) i.series.input(e, t, o);
            }
            i.fetch = function c(e, r) {
                var i = e * n - Date.now();
                var o = r - e;
                var a = [];
                for (var f = 0; f < t.length; f++) {
                    if (t[f].archive_source) {
                        a.push(s({}, t[f], {
                            source: t[f].archive_source,
                            timestamp: i,
                            limit: o
                        }));
                    }
                }
                l(a, u, true);
            };
            i.follow = function d() {
                l(t, u);
            };
            i.close = function p(e) {
                var n, t = o.length;
                for (n = 0; n < t; n++) o[n].close(e);
            };
        }
        e.metrics = function cn(e, n) {
            return new je(e, n);
        };
        e.oops = function dn() {
            if (window.parent !== window && window.name.indexOf("cockpit1:") === 0) window.parent.postMessage('\n{ "command": "oops" }', w);
        };
        var Oe;
        if (window.navigator.userAgent.indexOf("PhantomJS") == -1) {
            Oe = window.onerror;
            window.onerror = function(n, t, r) {
                e.oops();
                if (Oe) return Oe(n, t, r);
                return false;
            };
        }
    }
    var N = {};
    j(N, {});
    var T = false;
    function J() {
        if (!T) {
            P(N);
            T = true;
        }
        return N;
    }
    var R;
    var D = document.scripts[document.scripts.length - 1].src || "";
    var $ = D.indexOf("/cockpit.js");
    if ($ === -1) $ = D.indexOf("/cockpit.min.js");
    if ($ !== -1) $ = D.substring(0, $).lastIndexOf("/");
    if ($ !== -1) {
        R = D.substring($ + 1, D.indexOf(".", $ + 1));
        window.cockpit = J();
    }
    if (r(window.define) && window.define.amd) {
        if (R) define(R, [], window.cockpit); else define([], J);
    }
})();
//# sourceMappingURL=cockpit.min.js.map
